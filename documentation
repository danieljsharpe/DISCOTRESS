##### DOCUMENTATION OF INPUT KEYWORDS AND ARGUMENTS FOR enhanced_kmc KINETIC MONTE CARLO SUITE #####

these keywords appear in the input file named "input.kmc"

mandatory input files containing the network information:
  stat_prob.dat   - single col, ln stationary probabilities for nodes
  ts_conns.dat    - double col, edge connecting node IDs (each is assumed to be bidirectional)
  ts_weights.dat  - single col, ln transition rate for forward and reverse transitions (two lines per line in ts_conns.dat)
  min.A           - single col, node IDs in the final set A (indexed from 1)
  min.B           - single col, node IDs in the initial set B (indexed from 1)
optional input files containing the network information:
  communities.dat - single col, community IDs (indexed from 0) for nodes

### MAIN KEYWORDS ###

NNODES <int>
  mandatory, number of nodes in the transition network

NEDGES <int>
  mandatory, number of (bidirectional) edges in the transition network

TRAJ <str>
  mandatory if not ENHANCED KPS, method for propagating individual kMC trajectories
  OPTIONS
    BKL - Bortz-Kalos-Lebowitz (aka n-fold way) rejection-free algorithm
    REJ - rejection algorithm
    LEAPFROG - kMC employing leapfrog moves

ENHANCED <str>
  mandatory, employ an enhanced sampling strategy for accelerating the observation of rare events
  OPTIONS
    WE - weighted ensemble sampling
    KPS - kinetic path sampling
    FFS - forward flux sampling
    ASKMC - accelerated superbasin kMC
    NEUS - non-equilibrium umbrella sampling
    MILES - milestoning
    TPS - transition path sampling
    NONE - no enhanced sampling strategy employed

MINAFILE <str> <int>
  mandatory, name of the file containing the node ID's (indexed from 1) belonging to the A (final) set and no. of nodes in A

MINBFILE <str> <int>
  mandatory, name of the file containing the node ID's (indexed from 1) belonging to the B (initial) set and no. of nodes in B

NABPATHS <int>
  mandatory, the simulation is terminated when this number of A-B paths have been successfully sampled

### OPTIONAL KEYWORDS RELATING TO ENHANCED SAMPLING ###

INITCONDFILE <str>
  optional. Name of the file containing initial occupation probabilities for nodes in B that are alternative to the
    stationary probabilities. The number of entries is assumed to be the same as the specified number of nodes in B,
    and the specified order is assumed to be the same also (cf MINBFILE)

BINFILE <str> <int>
  mandatory if ENHANCED WE or ENHANCED KPS and not ADAPTIVEBINS
    name of the file containing the definitions of communities (single-column, indexed from zero, number of entries equal
    to the number of nodes in the network) and no. of communities. Is overridden by ADAPTIVEBINS
    the communities are used in the calculation of transition path statistics (ie committor functions and
    transition path probability densities). For enhanced sampling methods, the communities are used to divide the state
    space (eg the communities define the trapping basins in KPS, or the bins in WE). The specification of communities must be
    consistent with the definition of the A and B sets. An exception is if the number of communities is 2, in which case the
    initial set B can be a subset of the relevant community

ADAPTIVEBINS
  mandatory if ENHANCED WE or ENHANCED KPS and not BINFILE, default False
    set the partitioning of the state space leveraged in WE-kMC and in kPS to be defined on-the-fly

BINTARGFILE <str>
  mandatory if ENHANCED WE and not ADAPTIVEBINS, name of the file containing the target number of trajectories in each bin
    (single-column, number of entries equal to the number of communities in the network)

BININITFILE <str>
  optional, if ENHANCED WE and not ADAPTIVEBINS, name of the file containing the initial trajectory probability distribution
    over nodes

TAU <long double>
  mandatory if ENHANCED WE or if ENHANCED KPS and not BRANCHPROBS
    If WE, tau is the time between resampling trajectories
    If KPS, tau is the lag time at which the linear transition probability matrices are estimated (or provided, if TRANSNPROBS)

KPSKMCSTEPS <int>
  optional, if ENHANCED KPS, the number of standard BKL kMC steps to be performed after a kPS escape from
    a trapping basin. Default 0 (pure kPS, no kMC steps). Requires BRANCHPROBS to be set.

NELIM <int>
  mandatory if ENHANCED KPS, the maximum number of nodes that can be eliminated from the current trapping basin. If
    NELIM exceeds the number of nodes in the largest community, then all states of any trapping basin are always eliminated.
    Note that NELIM is equal to the maximum number of transition matrices stored for the active sub-network, and therefore
    the choice of this keyword (along with the sizes of communities) can strongly affect memory usage.

### OTHER OPTIONAL KEYWORDS ###

MAXIT <int>
  default is inf. The maximum number of iterations of the relevant algorithm to run before the simulation is terminated (if the
  target number of A-B paths to simulate is not reached). The interpretation of this option depends on the chosen enhanced
  sampling method.
    WE - number of iterations of the resampling procedure
    KPS - number of basin escape trajectories simulated
    NONE - number of iterations of the standard kMC algorithm

BRANCHPROBS
  the transition probabilities are calculated as the branching probabilities

TRANSNPROBS
  the weights to read in are transition probabilities, not rates (compatible with ENHANCED KPS only)
  the self-loop transition probabilities for nodes are inferred to be the remainders

PFOLD
  when used in conjunction with ENHANCED KPS, specifies that a committor function calculation is performed instead of a kPS simulation
  the communities.dat file must specify precisely three communities; the A set, the B set, and the set of all other nodes
  the committor functions are written to the files "committor_AB.dat" and "committor_BA.dat" (for A<-B and B<-A directions, respectively)

TINTVL <double>
  ignored if ENHANCED KPS. Time interval for dumping trajectory information
  negative value (default) indicates that trajectory data is not written
  zero value specifies that all trajectory information is written

SEED <int>
  seed for the random number generators

DEBUG
  enable extra printing and tests to aid debugging
